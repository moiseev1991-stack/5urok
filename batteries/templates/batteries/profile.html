{% extends 'batteries/base.html' %}

{% block title %}–ü—Ä–æ—Ñ–∏–ª—å - –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤{% endblock %}

{% block content %}
<h1 style="text-align: center; margin-bottom: 30px;">üë§ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>

<div style="background-color: #161b22; border: 1px solid #30363d; color: #c9d1d9; padding: 32px; border-radius: 6px; text-align: center; margin-bottom: 24px;">
    <h2 style="margin-bottom: 15px; color: #f0f6fc;">{{ user.username }}</h2>
    <p style="font-size: 16px; color: #8b949e;">Email: {{ user.email|default:"–Ω–µ —É–∫–∞–∑–∞–Ω" }}</p>
</div>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 30px;">
    <div style="background-color: #0d1117; border: 1px solid #30363d; padding: 20px; border-radius: 6px; text-align: center;">
        <h3 style="color: #58a6ff; margin-bottom: 10px;">{{ user_total }}</h3>
        <p style="color: #8b949e;">–í—Å–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤</p>
    </div>
    <div style="background-color: #0d1117; border: 1px solid #30363d; padding: 20px; border-radius: 6px; text-align: center;">
        <h3 style="color: #58a6ff; margin-bottom: 10px;">{{ submission_count }}</h3>
        <p style="color: #8b949e;">–í—Å–µ–≥–æ —Å–¥–∞—á</p>
    </div>
</div>

{% if user_stats_by_type %}
<div style="margin-bottom: 30px; background-color: #0d1117; border: 1px solid #30363d; padding: 20px; border-radius: 6px;">
    <h3 style="color: #f0f6fc; margin-bottom: 16px; font-size: 18px;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º:</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px;">
        {% for stat in user_stats_by_type %}
        <div style="background-color: #161b22; border: 1px solid #30363d; padding: 12px; border-radius: 6px;">
            <p style="color: #58a6ff; font-weight: 600; margin-bottom: 4px;">{{ stat.total }}</p>
            <p style="color: #8b949e; font-size: 14px;">
                {% if stat.device_type == 'battery' %}–ë–∞—Ç–∞—Ä–µ–π–∫–∏
                {% elif stat.device_type == 'lamp' %}–õ–∞–º–ø—ã
                {% elif stat.device_type == 'powerbank' %}Power Banks
                {% else %}{{ stat.device_type }}{% endif %}
            </p>
            <p style="color: #6e7681; font-size: 12px;">{{ stat.count }} –∑–∞–ø–∏—Å–µ–π</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<h2 style="margin-bottom: 20px;">–ò—Å—Ç–æ—Ä–∏—è —Å–¥–∞—á</h2>

{% if user_submissions %}
<table>
    <thead>
        <tr>
            <th>–¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞</th>
            <th>–î–∞—Ç–∞ —Å–¥–∞—á–∏</th>
            <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
            <th>–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏</th>
        </tr>
    </thead>
    <tbody>
        {% for submission in user_submissions %}
        <tr>
            <td>
                {% if submission.device_type == 'battery' %}–ë–∞—Ç–∞—Ä–µ–π–∫–∏
                {% elif submission.device_type == 'lamp' %}–õ–∞–º–ø—ã
                {% elif submission.device_type == 'powerbank' %}Power Banks
                {% else %}{{ submission.device_type }}{% endif %}
            </td>
            <td>{{ submission.date_submitted|date:"d.m.Y H:i" }}</td>
            <td>{{ submission.quantity }}</td>
            <td>{{ submission.created_at|date:"d.m.Y H:i" }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% else %}
<div style="text-align: center; padding: 40px; background-color: #0d1117; border: 1px solid #30363d; border-radius: 6px;">
    <p style="color: #8b949e; font-size: 16px; margin-bottom: 20px;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –æ —Å–¥–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö</p>
    <a href="{% url 'submit_batteries' %}" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—É—é —Å–¥–∞—á—É</a>
</div>
{% endif %}

<div style="text-align: center; margin-top: 30px;">
    <a href="{% url 'submit_batteries' %}" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Å–¥–∞—á—É</a>
</div>
{% endblock %}
